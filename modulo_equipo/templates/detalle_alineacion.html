{% extends 'admin/base_site.html' %}

{% block content %}
  <!-- Agrega aquí tu contenido personalizado -->
  <!DOCTYPE html>
  <html lang="en">
    <head>
      <title>Title</title>
      <!-- Required meta tags -->
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />

      <!-- Bootstrap CSS v5.2.1 -->
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous" />
    </head>

    <body>
      <div class="row justify-content-center align-items-center g-2">
        <br />
        <hr />
        <div class="row">
          <!-- Competición -->
          <div class="col-md-3">
            <label for="" class="form-label"><b>Seleccione Competición</b></label>
            <select class="form-select form-select-sm" name="" id="competicionSelect">
              <option value="">--------</option>
            </select>
          </div>
          <!-- ENCUENTROS -->
          <div class="col-md-6">
            <label for="" class="form-label"><b>Seleccione encuentro</b></label>
            <select class="form-select form-select-sm" name="" id="encuentroSelect">
              <option value="">--------</option>
            </select>
          </div>
          <br />
          <br />
        </div>
        <div class="mb-3">
          <br />
        </div>

        <div class="col-md-6">
          <div class="card-group">
            <div class="card">
              <div class="card-body">
                <h4 class="card-title">PARAGUAY (PAR)</h4>
                <hr />
                <!-- formacion -->
                <div class="row justify-content-center align-items-center g-2">
                  <div class="col-md-4">
                    <label for="" class="form-label"><b>Seleccione Formacion:</b></label>
                  </div>
                  <div class="col-md-8">
                    <select class="form-select form-select-sm" name="" id="formacionSelectEL">
                      <option value="">--------</option>
                    </select>
                  </div>
                </div>
                <hr />
                <!-- TABLAS -->
                <div class="table-responsive-sm">
                  <table id="miTabla_e_l" class="table table-striped table-hover table-borderless table-light align-middle">
                    <thead class="table-primary">
                      <tr>
                        <th>ID</th>
                        <th>JUGADOR</th>
                        <th>POSICION</th>
                        <th>TITULAR</th>
                        <th>DORSAL</th>
                      </tr>
                    </thead>
                    <tbody class="table-group-divider">
                      <tr class="table-">
                        <td scope="row">Item</td>
                        <td scope="row">Item</td>
                        <td>
                          <select class="form-select form-select-sm" name="" id="posSelect">
                            <option value="">--------</option>
                          </select>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="" />
                            <label class="form-check-label" for="">SI</label>
                          </div>
                        </td>
                        <td>
                          <input type="number" class="form-control" name="" id="" aria-describedby="helpId" placeholder="" />
                        </td>
                      </tr>
                      <tr class="table-">
                        <td scope="row">Item</td>
                        <td scope="row">Item</td>
                        <td>
                          <select class="form-select form-select-sm" name="" id="posSelect">
                            <option value="">--------</option>
                          </select>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="" />
                            <label class="form-check-label" for="">SI</label>
                          </div>
                        </td>
                        <td>
                          <input type="number" class="form-control" name="" id="" aria-describedby="helpId" placeholder="" />
                        </td>
                      </tr>
                    </tbody>
                    <tfoot></tfoot>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-md-6">
          <div class="card-group">
            <div class="card">
              <div class="card-body">
                <h4 class="card-title">PERÚ (PER)</h4>
                <hr />
                <!-- formacion -->
                <div class="row justify-content-center align-items-center g-2">
                  <div class="col-md-4">
                    <label for="" class="form-label"><b>Seleccione Formacion:</b></label>
                  </div>
                  <div class="col-md-8">
                    <select class="form-select form-select-sm" name="" id="formacionSelectEV">
                      <option value="">--------</option>
                    </select>
                  </div>
                </div>
                <hr />
                <!-- TABLAS -->
                <div class="table-responsive-sm">
                  <table id="miTabla_e_v" class="table table-striped table-hover table-borderless table-light align-middle">
                    <thead class="table-primary">
                      <tr>
                        <th>ID</th>
                        <th>JUGADOR</th>
                        <th>POSICION</th>
                        <th>SELECCIONAR</th>
                        <th>DORSAL</th>
                      </tr>
                    </thead>
                    <tbody class="table-group-divider">
                      <tr class="table-">
                        <td scope="row">Item</td>
                        <td scope="row">Item</td>
                        <td>
                          <select class="form-select form-select-sm" name="" id="posSelect">
                            <option value="">--------</option>
                          </select>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="" />
                            <label class="form-check-label" for="">Titular</label>
                            <br>
                            <input class="form-check-input" type="checkbox" value="" id="1" />
                            <label class="form-check-label" for="">Capitan</label>
                          </div>
                        </td>
                        <td>
                          <input type="number" class="form-control" name="" id="" aria-describedby="helpId" placeholder="" />
                        </td>
                      </tr>
                      <tr class="table-">
                        <td scope="row">Item</td>
                        <td scope="row">Item</td>
                        <td>
                          <select class="form-select form-select-sm" name="" id="posSelect">
                            <option value="">--------</option>
                          </select>
                        </td>
                        <td>
                          <div class="form-check">
                            <input class="form-check-input" type="checkbox" value="" id="" />
                            <label class="form-check-label" for="">Titular</label>
                            <br>
                            <input class="form-check-input" type="checkbox" value="" id="1" />
                            <label class="form-check-label" for="">Capitan</label>
                          </div>
                        </td>
                        <td>
                          <input type="number" class="form-control" name="" id="" aria-describedby="helpId" placeholder="" />
                        </td>
                      </tr>
                    </tbody>
                    <tfoot></tfoot>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Bootstrap JavaScript Libraries -->
      <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.min.js" integrity="sha384-7VPbUDkoPSGFnVtYi0QogXtr74QeVeeIs99Qfg5YCF+TidwNdjvaKZX19NZ/e6oz" crossorigin="anonymous"></script>
      <!-- jQuery -->
      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <!-- DataTables -->
      <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css" />
      <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>
      <!-- TABLAS -->
      <script>
        $(document).ready(function () {
          $('#miTabla_e_l').DataTable({
            language: {
              url: '//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Spanish.json'
            }
          })
          $('#miTabla_e_v').DataTable({
            language: {
              url: '//cdn.datatables.net/plug-ins/9dcbecd42ad/i18n/Spanish.json'
            }
          })
        })
      </script>
      <!-- cargar competiciones -->
      <script>
        $(document).ready(function () {
          const competicionSelect = $('#competicionSelect')
          $.get('/modulo_competicion/obtener-competiciones/', function (data) {
            data.forEach(function (competicion) {
              competicionSelect.append(
                $('<option>', {
                  value: competicion.id,
                  text: competicion.nombre
                })
              )
            })
          })
        })
      </script>
      <!-- cargar posicion jugador -->
      <script>
        $(document).ready(function () {
          const posSelect = $('#posSelect')
          $.get('/modulo_equipo/obtener-posicion-jugador/', function (data) {
            data.forEach(function (x) {
              posSelect.append(
                $('<option>', {
                  value: x.id,
                  text: x.descripcion // Cambiado 'nombre' a 'descripcion'
                })
              )
            })
          })
        })
      </script>
      <!-- cargar formaciones -->
      <script>
        $(document).ready(function () {
          const formacionSelect = $('#formacionSelectEL')
          $.get('/modulo_equipo/obtener-formacion/', function (data) {
            data.forEach(function (formacion) {
              formacionSelect.append(
                $('<option>', {
                  value: formacion.id,
                  text: formacion.descripcion
                })
              )
            })
          })
        })
      </script>
      <script>
        $(document).ready(function () {
          const formacionSelect = $('#formacionSelectEV')
          $.get('/modulo_equipo/obtener-formacion/', function (data) {
            data.forEach(function (formacion) {
              formacionSelect.append(
                $('<option>', {
                  value: formacion.id,
                  text: formacion.descripcion
                })
              )
            })
          })
        })
      </script>

      <!-- Agrega el siguiente código JavaScript para manejar la solicitud AJAX y actualizar el select de encuentros -->
      <script>
        $(document).ready(function () {
          const competicionSelect = $('#competicionSelect')
          const encuentroSelect = $('#encuentroSelect')
        
          // Maneja el evento de cambio en el select de competiciones
          competicionSelect.on('change', function () {
            const competicionSeleccionada = $(this).val()
            if (competicionSeleccionada) {
              // Realiza una solicitud AJAX para obtener los encuentros no jugados
              $.get('/modulo_encuentros/obtener-encuentros-no-jugados/', { competicion_id: competicionSeleccionada }, function (data) {
                // Llena el select de encuentros con los resultados de la solicitud AJAX
                encuentroSelect.empty()
                $.each(data, function (index, encuentro) {
                  // Agrega cada encuentro al select
                  encuentroSelect.append(
                    $('<option>', {
                      value: index, // Puedes usar el índice como valor
                      text: encuentro // El texto es la cadena del encuentro
                    })
                  )
                })
              })
            } else {
              // Borra el select de encuentros si no se ha seleccionado una competición
              encuentroSelect.empty()
            }
          })
        })
      </script>

      <script>
        $(document).ready(function () {
          const competicionSelect = $('#competicionSelect')
          const encuentroSelect = $('#encuentroSelect')
          const tablaEquipoLocal = $('#miTabla_e_l')
          const tablaEquipoVisitante = $('#miTabla_e_v')
        
          // Maneja el evento de cambio en el select de competiciones
          competicionSelect.on('change', function () {
            const competicionSeleccionada = $(this).val()
            if (competicionSeleccionada) {
              // Realiza una solicitud AJAX para obtener los encuentros no jugados
              $.get('/modulo_encuentros/obtener-encuentros-no-jugados/', { competicion_id: competicionSeleccionada }, function (data) {
                // Llena el select de encuentros con los resultados de la solicitud AJAX
                encuentroSelect.empty().append('<option value="">Seleccionar Encuentro</option>')
                $.each(data, function (index, encuentro) {
                  encuentroSelect.append(
                    $('<option>', {
                      value: index,
                      text: encuentro
                    })
                  )
                })
              })
            } else {
              // Borra el select de encuentros si no se ha seleccionado una competición
              encuentroSelect.empty().append('<option value="">Seleccionar Competición</option>')
              tablaEquipoLocal.empty()
              tablaEquipoVisitante.empty()
            }
          })
        
          // Maneja el evento de cambio en el select de encuentros
          encuentroSelect.on('change', function () {
            const encuentroSeleccionado = $(this).val()
            if (encuentroSeleccionado) {
              // Realiza una solicitud AJAX para obtener los jugadores de los equipos
              $.get('/modulo_encuentros/obtener-jugadores-equipo/', { encuentro_id: encuentroSeleccionado }, function (data) {
                // Llena las tablas con los resultados de la solicitud AJAX
                llenarTabla(tablaEquipoLocal, data.equipoLocal)
                llenarTabla(tablaEquipoVisitante, data.equipoVisitante)
              })
            } else {
              // Borra las tablas si no se ha seleccionado un encuentro
              tablaEquipoLocal.empty()
              tablaEquipoVisitante.empty()
            }
          })
        
          // Función para llenar una tabla con datos
          function llenarTabla(tabla, datos) {
            // Limpia la tabla
            tabla.empty()
            // Agrega filas con datos
            datos.forEach(function (jugador) {
              const fila = $('<tr>')
              fila.append($('<td>', { text: jugador.id }))
              fila.append($('<td>', { text: jugador.nombre }))
              fila.append(
                $('<td>').append(
                  $('<div>', { class: 'form-check' })
                    .append($('<input>', { class: 'form-check-input', type: 'checkbox', value: '', id: 'titular' + jugador.id }))
                    .append($('<label>', { class: 'form-check-label', for: 'titular' + jugador.id, text: 'SI' }))
                )
              )
              fila.append($('<td>').append($('<input>', { class: 'form-control', name: 'dorsal' + jugador.id, id: 'dorsal' + jugador.id, placeholder: '' })))
              tabla.append(fila)
            })
          }
        })
      </script>
    </body>
  </html>
{% endblock %}
